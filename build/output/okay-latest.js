// Okay.JS
// by Hunter Loftis <hunter@hunterloftis.com>
//
// Version 0.1.0
window.ok=window.ok||{};
(function(b){function d(a){a.m=[];a.subscribe=h.l;a.publish=h.j;a.unsubscribe=h.g;a.D=!0}b.dom={};b.template={};b.binding={};var a,c,j={},h={l:function(a,b){this.m.push({i:a,w:b||this});a.f=a.f||[];_(a.f).contains(this)||a.f.push(this)},j:function(a){_(this.m).c(function(b){b.i.call(b.w,a)},this)},g:function(a){this.m=_(this.m).J(function(b){return b.i===a});a.f=_(a.f).M(this)}};b.base=function(b){function e(){if(arguments.length>0)return g!==arguments[0]&&(g=arguments[0],e.j(g)),this;a&&c.push(e);
return g}var g=b;d(e);return e};b.collection=function(b){function e(){if(arguments.length>0)return f=arguments[0],e.j(f),this;a&&c.push(e);return f}function g(a){return function(){typeof f==="undefined"&&(f=[]);var b=f[a].apply(f,arguments);e.j(f);return b}}var f=b;_(["pop","push","reverse","shift","sort","splice","unshift"]).c(function(a){e[a]=g(a)});d(e);return e};b.dependent=function(b,e){function g(){a&&c.push(g);return k}function f(){var d=f.f?f.f.slice():[],j;a=!0;c=[];k=b.call(e);a=!1;j=c=
_.K(c);var h=_(d).select(function(a){return!_(j).contains(a)}),m=_(j).select(function(a){return!_(d).contains(a)});_(h).c(function(a){a.g(f)});_(m).c(function(a){a.l(f)});g.j(k)}var k;d(g);f();return g};b.bind=function(a,c,d){var c=c||"",f="data-bind"+(c.length>0?"-"+c:""),d=b.b.H(f,d),k=j[c]=[];_(d).c(function(c){var d=b.b.v(c,f);with(a)eval("var bindingObject = {"+d+"}");_.c(bindingObject,function(d,e){var g=b.h[e](c,d,a);k.push(g)})})};b.unbind=function(a){var a=a||"",b=j[a];if(b)_(b).c(function(a){a.k()}),
j[a]=[];else throw Error("Nothing is bound to namespace '"+a+"'");};b.safeSubscribe=function(a,b,c){a.l?(a.l(b,c),b.call(c,a())):b.call(c,a)}})(ok);
(function(b){var d=ok.b;d.nodesWithAttr=function(a,c){if(c)return b(c).find("*["+a+"]");return b("*["+a+"]")};d.createNode=function(a){return b(a)};d.append=function(a,c){b(a).append(c)};d.remove=function(a){b(a).remove()};d.after=function(a,c){b(a).F(c)};d.before=function(a,c){b(a).q(c)};d.attr=function(a,c){return b(a).v(c)};d.show=function(a){b(a).show()};d.hide=function(a){b(a).z()};d.text=function(a,c){b(a).n(c)};d.html=function(a,c){return b(a).n(c)};d.value=function(a,c){return b(a).L(c)};
d.bind=function(a,c,d,h){function i(){d.call(h)}b(a).bind(c,i);return i};d.unbind=function(a,c,d){b(a).t(c,d)}})(Zepto);(function(b){ok.o.r=function(d,a){return b.o(d,a)}})(_);(function(b){function d(a,c){this.a=a;this.d=c;b.s(c,this.update,this)}d.prototype={update:function(a){a?b.b.show(this.a):b.b.z(this.a)},k:function(){this.d.g(this.update)}};b.h.visible=function(a,b){return new d(a,b)}})(ok);
(function(b){function d(a,c){this.a=a;this.d=c;b.s(c,this.update,this)}d.prototype={update:function(a){b.b.n(this.a,a)},k:function(){this.d.g(this.update)}};b.h.html=function(a,b){return new d(a,b)}})(ok);(function(b){function d(a,b){this.a=a;this.i=b;$(a).bind("click",_.bind(this.u,this))}d.prototype={u:function(a){this.i()||(a.preventDefault(),a.stopPropagation())},k:function(){$(node).t("click",this.i)}};b.h.click=function(a,b){return new d(a,b)}})(ok);
(function(b){function d(a,c){this.a=a;this.d=c;c.l(this.p,this);this.p(c());this.A=b.b.bind(a,"keyup",this.C,this)}d.prototype={p:function(a){b.b.value(this.a,a)},C:function(){this.d(b.b.value(this.a))},k:function(){this.d.g(this.p);b.b.t(this.a,"keyup",this.A)}};b.h.value=function(a,b){return new d(a,b)}})(ok);
(function(b){function d(a,c){this.a=a;this.B="#"+c.o;this.d=c.G;this.e=[];b.b.n(this.a,"");b.s(this.d,this.update,this)}d.prototype={update:function(a){var c=this,d=b.b.n(this.B),h=_(this.e).I("data"),i,e,g=[];_(a).c(function(a,f){if(c.e.length>f)if(i=c.e[f],i.data===a)g.push(i);else{var l=_(h).indexOf(a);l>=0?(b.b.q(i.a,c.e[l].a),g.push(c.e[l])):(e=b.b.createNode(b.o.r(d,a)),b.bind(a,null,e),b.b.q(i.a,e),g.push({data:a,a:e}))}else e=b.b.createNode(b.o.r(d,a)),b.bind(a,null,e),b.b.append(c.a,e),g.push({data:a,
a:e})});var f=[];_(this.e).c(function(b){_(a).contains(b.data)||f.push(b)});_(f).c(function(a){b.b.remove(a.a)});this.e=g},k:function(){this.d.g(this.update)}};b.h.repeat=function(a,b){return new d(a,b)}})(ok);
